# 工作负载饱和度分析系统 - 项目总结

## 📋 项目信息

**项目名称**: 工作负载饱和度分析系统
**版本**: 2.0.0
**最后更新**: 2025-11-24
**技术栈**: Streamlit + Pandas + Plotly

## ✨ 核心功能

### 1. 数据管理
- 📤 Excel文件上传与解析
- 📊 自动数据处理与验证
- 💾 历史数据存储与管理
- 🗑️ 文件删除与清理

### 2. 负载分析
- 📈 三周工作负载计算(本周、下周、下下周)
- 📊 饱和度统计与分类
- ⚠️ 异常数据提醒
- 📉 负载变化率分析

### 3. 数据可视化
- 🎨 交互式图表展示
- 📊 多维度数据对比
- 🔍 详细数据预览
- 📱 响应式UI设计

### 4. 趋势对比
- 📉 历史数据对比分析
- 📈 趋势变化追踪
- 📊 团队状态分布
- 💾 数据导出功能

### 5. 配置管理
- ⚙️ 灵活的参数配置
- 🎯 饱和度阈值调整
- 🔧 系统设置管理

## 🎯 最新更新

### UI优化 (2025-11-24)
1. **侧边栏精简** - 移除冗余信息,保持界面简洁
2. **统计卡片交互** - 点击展开查看成员详情
3. **异常提醒增强** - 添加判断标准说明
4. **表格配色统一** - 三个周期的数据表格样式一致

## 📂 项目结构

```
Workload/
├── app.py                    # 主程序入口
├── config.yaml              # 系统配置
├── requirements.txt         # 依赖包列表
├── README.md               # 使用说明
├── DEPLOYMENT.md           # 部署文档
├── PROJECT_REFACTOR.md     # 代码分析报告
├── SUMMARY.md              # 本文档
├── .streamlit/             # Streamlit配置
├── core/                   # 核心逻辑
│   ├── data_processor.py  # 数据处理
│   ├── storage.py         # 存储管理
│   └── visualizer.py      # 可视化
├── pages/                  # 页面模块
│   ├── 1_📊_数据上传.py
│   ├── 2_🔍_数据预览.py
│   ├── 3_📈_负载分析.py
│   ├── 4_📉_趋势对比.py
│   └── 5_⚙️_配置管理.py
├── utils/                  # 工具函数
│   ├── config_loader.py
│   ├── formatters.py
│   ├── sidebar.py
│   ├── styles.py
│   └── validators.py
└── data/                   # 数据目录
    ├── uploads/           # 原始文件
    └── processed/         # 处理后数据
```

## 🚀 快速开始

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 运行应用
streamlit run app.py

# 3. 访问应用
# 浏览器打开 http://localhost:8504
```

## 📊 数据格式要求

Excel文件必须包含:
- **Sheet名称**: "预估工时"
- **第一列**: 成员名称
- **其他列**: 日期列(YYYY-MM-DD格式),值为工时(小时)

## 💡 使用流程

1. **上传数据** → 在"数据上传"页面上传Excel文件
2. **预览数据** → 在"数据预览"页面检查处理结果
3. **分析负载** → 在"负载分析"页面查看详细分析
4. **趋势对比** → 在"趋势对比"页面查看历史对比
5. **调整配置** → 在"配置管理"页面调整参数

## 🎨 状态说明

- 🔴 **超负荷**: 饱和度 > 110%
- 🟢 **正常**: 饱和度 90% - 110%
- 🔵 **不饱和**: 饱和度 < 90%
- ⚪ **空闲**: 饱和度 = 0%

## ⚠️ 异常数据判断标准

- 🚨 **极度超负荷**: 下周饱和度 > 150%
- ⚠️ **工时大幅增加**: 下周工时比本周增加 > 20小时

## 📈 统计功能

- 平均饱和度计算
- 状态分布统计
- 变化率追踪
- 成员详情展示(点击卡片查看)

## 🔧 配置选项

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| standard_hours_per_week | 标准周工时 | 40小时 |
| other_tasks.weekly_minutes_per_person | 其他事务时间 | 92分钟 |
| saturation_thresholds.under_saturated_max | 不饱和上限 | 90% |
| saturation_thresholds.normal_min | 正常下限 | 90% |
| saturation_thresholds.normal_max | 正常上限 | 110% |
| saturation_thresholds.over_saturated_min | 超负荷下限 | 110% |

## 📝 注意事项

1. **数据安全**: 所有数据存储在本地,不上传到外部服务器
2. **文件大小**: 建议单个Excel文件不超过10MB
3. **数据格式**: 确保日期列格式正确(YYYY-MM-DD)
4. **浏览器兼容**: 推荐使用Chrome/Edge/Firefox最新版本

## 🛠️ 技术细节

- **后端**: Python 3.8+
- **Web框架**: Streamlit 1.28.0
- **数据处理**: Pandas 2.1.1
- **图表库**: Plotly 5.17.0
- **配置管理**: YAML

## 📞 支持

如遇问题,请查看:
1. `README.md` - 详细使用说明
2. `DEPLOYMENT.md` - 部署指南
3. `PROJECT_REFACTOR.md` - 技术分析报告

## 📜 更新日志

### v2.0.0 (2025-11-24)
- ✨ 全新UI设计
- 📊 增强数据预览功能
- 🎯 添加可点击统计卡片
- ⚠️ 完善异常数据提醒
- 🎨 优化表格配色
- 📝 完善项目文档

### v1.0.0
- 🎉 初始版本发布
- 📤 基础数据上传功能
- 📊 核心分析功能
- 📈 基础可视化展示

---

**项目状态**: ✅ 稳定运行
**维护状态**: 🟢 持续维护
**代码质量**: ⭐⭐⭐⭐ (4/5)
