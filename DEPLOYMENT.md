# 部署说明文档

## 项目迁移完成 ✅

工作负载饱和度分析系统已成功从命令行工具迁移到基于Streamlit的Web应用。

## 部署状态

- ✅ 核心功能模块重构完成
- ✅ 5个Web页面开发完成
- ✅ 依赖包安装成功
- ✅ 应用测试运行成功
- ✅ 浏览器访问正常

## 快速启动

### 方法1: 使用启动脚本(推荐)

```bash
cd /Users/admin/Desktop/Workload
./start.sh
```

### 方法2: 手动启动

```bash
cd /Users/admin/Desktop/Workload
python3 -m streamlit run app.py
```

### 方法3: 指定端口启动

```bash
python3 -m streamlit run app.py --server.port 8501
```

## 访问地址

启动后,浏览器会自动打开,或手动访问:

```
http://localhost:8501
```

## 项目结构

```
Workload/
├── app.py                     # 主应用入口 ✅
├── config.yaml               # 配置文件 ✅
├── requirements.txt          # 依赖清单 ✅
├── start.sh                  # 启动脚本 ✅
├── README.md                 # 使用文档 ✅
├── DEPLOYMENT.md            # 本文档 ✅
│
├── core/                     # 核心模块 ✅
│   ├── __init__.py
│   ├── data_processor.py     # 数据处理
│   ├── storage.py           # 存储管理
│   └── visualizer.py        # 可视化
│
├── pages/                    # 页面模块 ✅
│   ├── 1_📊_数据上传.py      # 文件上传
│   ├── 2_🔍_数据预览.py      # 数据预览(新增)
│   ├── 3_📈_负载分析.py      # 负载分析
│   ├── 4_📉_趋势对比.py      # 趋势对比
│   └── 5_⚙️_配置管理.py      # 配置管理
│
├── utils/                    # 工具模块 ✅
│   ├── __init__.py
│   ├── validators.py        # 数据验证
│   └── formatters.py        # 格式化
│
└── data/                     # 数据目录 ✅
    ├── uploads/             # 上传文件
    ├── processed/           # 处理数据
    └── reports/             # 生成报告
```

## 已完成功能

### 1. 数据上传页面 📊
- Excel文件上传
- 基准日期选择
- 数据处理管道
- 上传历史管理
- 快速统计预览

### 2. 数据预览页面 🔍 (新增)
- 三周数据分段展示
- 状态筛选和成员搜索
- 颜色编码状态标识
- 数据异常检测
- CSV导出功能

### 3. 负载分析页面 📈
- 三周工作负载分布图
- 交互式Plotly图表
- 变化率可视化
- 统计摘要展示
- 多格式报告导出(Excel/CSV/JSON)
- 智能分析建议

### 4. 趋势对比页面 📉
- 历史数据列表
- 多期数据选择
- 趋势图表对比
- 跨期变化分析
- 团队状态分布
- 历史数据管理

### 5. 配置管理页面 ⚙️
- 标准工时配置
- 饱和度阈值设置
- 其他事务配置
- 阈值可视化
- 示例计算
- 配置导入导出

## 技术架构

### 前端框架
- Streamlit 1.51.0 - Web框架
- Plotly 6.5.0 - 交互式图表

### 数据处理
- Pandas 2.3.3 - 数据分析
- NumPy 2.3.4 - 数值计算
- openpyxl 3.1.5 - Excel处理

### 配置管理
- PyYAML 6.0.3 - YAML解析

### 其他依赖
- python-dateutil - 日期处理
- logging - 日志记录

## 数据流程

```
用户上传Excel
    ↓
数据验证
    ↓
工作负载计算
    ↓
统计分析
    ↓
数据存储(JSON)
    ↓
可视化展示
    ↓
报告导出
```

## 核心功能说明

### 饱和度计算公式

```
总工时 = 项目工时 + 其他事务工时
饱和度 = (总工时 / 标准工时) × 100%
```

### 周期定义
- **本周**: 从本周一到本周日
- **下周**: 从下周一到下周日
- **下下周**: 从下下周一到下下周日

### 状态分级
- 🔴 超负荷: 饱和度 > 110%
- 🟢 正常: 饱和度 90% - 110%
- 🔵 不饱和: 饱和度 < 90%
- ⚪ 空闲: 饱和度 = 0%

## 数据安全

- 所有数据本地存储
- 无需外部数据库
- 文件系统权限保护
- 历史数据自动管理(90天清理)

## 性能优化

- Session State 数据缓存
- 配置文件缓存(@st.cache_resource)
- 按需加载历史数据
- 分页显示大数据集

## 使用建议

1. **首次使用**
   - 在配置管理页面检查默认参数
   - 根据团队实际情况调整阈值
   - 准备好Excel格式数据

2. **日常使用**
   - 定期上传最新工作负载数据
   - 使用数据预览验证计算正确性
   - 在负载分析页面查看可视化结果
   - 关注超负荷和空闲成员

3. **历史分析**
   - 定期查看趋势对比页面
   - 分析团队负载变化规律
   - 根据趋势优化资源分配

## 故障排查

### 应用无法启动

1. 检查Python版本: `python3 --version` (需要 ≥3.8)
2. 重新安装依赖: `pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple`
3. 检查端口占用: `lsof -i :8501`

### 数据上传失败

1. 检查Excel格式(需要"预估工时"sheet)
2. 确认日期列格式(YYYY-MM-DD)
3. 查看数据预览页面的错误提示

### 图表不显示

1. 确认已安装plotly: `pip3 show plotly`
2. 刷新浏览器页面
3. 检查浏览器控制台错误

## 下一步建议

### 功能增强
- [ ] 添加团队成员分组功能
- [ ] 支持多项目维度分析
- [ ] 实现邮件预警通知
- [ ] 添加移动端适配

### 数据增强
- [ ] 支持更多Excel格式
- [ ] 添加数据导入向导
- [ ] 实现数据备份功能
- [ ] 支持批量数据处理

### 可视化增强
- [ ] 更多图表类型
- [ ] 自定义图表样式
- [ ] 交互式仪表盘
- [ ] PDF报告生成

## 版本信息

- **当前版本**: v2.0.0
- **发布日期**: 2025-11-20
- **更新内容**:
  - ✅ 完全迁移到Web应用
  - ✅ 新增数据预览页面
  - ✅ 支持历史趋势对比
  - ✅ 可配置分析参数
  - ✅ 多格式报告导出

## 联系与支持

如有问题或建议,请联系开发团队。

---

**开发完成时间**: 2025-11-20
**开发状态**: ✅ 已完成并测试通过
**部署状态**: ✅ 应用正常运行中
